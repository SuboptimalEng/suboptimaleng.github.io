(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{3083:function(t,e,o){"use strict";function n(t,e,o,n,i,s,a){try{var h=t[s](a),r=h.value}catch(d){return void o(d)}h.done?e(r):Promise.resolve(r).then(n,i)}o.r(e),o.d(e,{default:function(){return f}});var i=o(7794),s=o.n(i),a=o(7294),h=o(3687),r=o(9477);function d(t,e,o){let{color:n=65280,scale:i=1,onInit:s,onUpdate:a}=void 0===o?{}:o;const d=[],c=new r.vBJ({color:null!=n?n:65280,wireframe:!0}),p=new h.AO,u=new h.AO,m=new h.AO,l=new h._f,v=new r.xo$(1),f=new r.DvJ(1,1,1),y=new r._12(10,10,10,10);function w(e){let o=new r.Kj0;const{SPHERE:n,BOX:i,PLANE:s,CYLINDER:a,CONVEXPOLYHEDRON:d,TRIMESH:l,HEIGHTFIELD:w}=h.bn.types;switch(e.type){case n:o=new r.Kj0(v,c);break;case i:o=new r.Kj0(f,c);break;case s:o=new r.Kj0(y,c);break;case a:{const t=new r.fHI(e.radiusTop,e.radiusBottom,e.height,e.numSegments);o=new r.Kj0(t,c),e.geometryId=t.id;break}case d:{const t=function(t){const e=new r.u9r,o=[];for(let i=0;i<t.vertices.length;i++){const e=t.vertices[i];o.push(e.x,e.y,e.z)}e.setAttribute("position",new r.a$l(o,3));const n=[];for(let i=0;i<t.faces.length;i++){const e=t.faces[i],o=e[0];for(let t=1;t<e.length-1;t++){const i=e[t],s=e[t+1];n.push(o,i,s)}}return e.setIndex(n),e.computeBoundingSphere(),e.computeVertexNormals(),e}(e);o=new r.Kj0(t,c),e.geometryId=t.id;break}case l:{const t=function(t){const e=new r.u9r,o=[],n=p,i=u,s=m;for(let a=0;a<t.indices.length/3;a++)t.getTriangleVertices(a,n,i,s),o.push(n.x,n.y,n.z),o.push(i.x,i.y,i.z),o.push(s.x,s.y,s.z);return e.setAttribute("position",new r.a$l(o,3)),e.computeBoundingSphere(),e.computeVertexNormals(),e}(e);o=new r.Kj0(t,c),e.geometryId=t.id;break}case w:{const t=function(t){const e=new r.u9r,o=t.elementSize||1,n=t.data.flatMap(((t,e)=>t.flatMap(((t,n)=>[e*o,n*o,t])))),i=[];for(let s=0;s<t.data.length-1;s++)for(let e=0;e<t.data[s].length-1;e++){const o=t.data[s].length,n=s*o+e;i.push(n+1,n+o,n+o+1),i.push(n+o,n+1,n)}return e.setIndex(i),e.setAttribute("position",new r.a$l(n,3)),e.computeBoundingSphere(),e.computeVertexNormals(),e}(e);o=new r.Kj0(t,c),e.geometryId=t.id;break}}return t.add(o),o}function g(e,o){let n=d[e],s=!1;return function(t,e){if(!t)return!1;const{geometry:o}=t;return o instanceof r.xo$&&e.type===h.bn.types.SPHERE||o instanceof r.DvJ&&e.type===h.bn.types.BOX||o instanceof r._12&&e.type===h.bn.types.PLANE||o.id===e.geometryId&&e.type===h.bn.types.CYLINDER||o.id===e.geometryId&&e.type===h.bn.types.CONVEXPOLYHEDRON||o.id===e.geometryId&&e.type===h.bn.types.TRIMESH||o.id===e.geometryId&&e.type===h.bn.types.HEIGHTFIELD}(n,o)||(n&&t.remove(n),d[e]=n=w(o),s=!0),function(t,e){const{SPHERE:o,BOX:n,PLANE:s,CYLINDER:a,CONVEXPOLYHEDRON:r,TRIMESH:d,HEIGHTFIELD:c}=h.bn.types;switch(e.type){case o:{const{radius:o}=e;t.scale.set(o*i,o*i,o*i);break}case n:t.scale.copy(e.halfExtents),t.scale.multiplyScalar(2*i);break;case s:break;case a:case r:t.scale.set(1*i,1*i,1*i);break;case d:t.scale.copy(e.scale).multiplyScalar(i);break;case c:t.scale.set(1*i,1*i,1*i)}}(n,o),s}return y.translate(0,0,1e-4),{update:function(){const o=d,n=p,i=l;let h=0;for(const t of e.bodies)for(let e=0;e!==t.shapes.length;e++){const r=t.shapes[e],d=g(h,r),c=o[h];c&&(t.quaternion.vmult(t.shapeOffsets[e],n),t.position.vadd(n,n),t.quaternion.mult(t.shapeOrientations[e],i),c.position.copy(n),c.quaternion.copy(i),d&&s instanceof Function&&s(t,c,r),!d&&a instanceof Function&&a(t,c,r)),h++}for(let e=h;e<o.length;e++){const n=o[e];n&&t.remove(n)}o.length=h}}}var c=o(2777),p=o(2262),u=o(9499),m=function(){function t(e){var o=this;(0,c.Z)(this,t),(0,u.Z)(this,"canvasId",void 0),(0,u.Z)(this,"fov",void 0),(0,u.Z)(this,"nearPlane",void 0),(0,u.Z)(this,"farPlane",void 0),(0,u.Z)(this,"canvas",void 0),(0,u.Z)(this,"onWindowResize",void 0),(0,u.Z)(this,"scene",void 0),(0,u.Z)(this,"camera",void 0),(0,u.Z)(this,"renderer",void 0),(0,u.Z)(this,"clock",void 0),(0,u.Z)(this,"ambientLight",void 0),(0,u.Z)(this,"directionalLight",void 0),(0,u.Z)(this,"cameraRotationDepth",void 0),this.fov=45,this.nearPlane=1,this.farPlane=1e3,this.canvasId=e,this.scene=new r.xsS,this.camera=new r.cPb(this.fov,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.y=4,this.canvas=document.getElementById(this.canvasId),this.renderer=new r.CP7({canvas:this.canvas,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.cameraRotationDepth=12,this.clock=new r.SUY,this.ambientLight=new r.Mig(16777215,.5),this.ambientLight.castShadow=!0,this.scene.add(this.ambientLight),this.directionalLight=new r.Ox3(16777215,1),this.directionalLight.position.set(0,32,64),this.scene.add(this.directionalLight),this.onWindowResize=function(){console.log("resize"),o.camera.aspect=window.innerWidth/window.innerHeight,o.camera.updateProjectionMatrix(),o.renderer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this.onWindowResize,!1)}return(0,p.Z)(t,[{key:"destroy",value:function(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);this.scene.removeFromParent(),this.camera.removeFromParent(),window.removeEventListener("resize",this.onWindowResize)}},{key:"update",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"udpateCameraPosition",value:function(){var t=Math.sin(.25*this.clock.getElapsedTime()),e=Math.cos(.25*this.clock.getElapsedTime());this.camera.position.x=this.cameraRotationDepth*t,this.camera.position.z=this.cameraRotationDepth*e,this.camera.lookAt(new r.Pa4(0,2,0))}}]),t}(),l=function(){function t(){(0,c.Z)(this,t),(0,u.Z)(this,"x",void 0),(0,u.Z)(this,"y",void 0),(0,u.Z)(this,"z",void 0),(0,u.Z)(this,"phantomX",void 0),(0,u.Z)(this,"phantomY",void 0),(0,u.Z)(this,"phantomZ",void 0),(0,u.Z)(this,"groundX",void 0),(0,u.Z)(this,"groundY",void 0),(0,u.Z)(this,"groundZ",void 0),(0,u.Z)(this,"size",void 0),(0,u.Z)(this,"mass",void 0),(0,u.Z)(this,"existingBlocks",void 0),(0,u.Z)(this,"phantomBlockAccepted",void 0),(0,u.Z)(this,"gameLoopLength",void 0),(0,u.Z)(this,"currentLoopLength",void 0),(0,u.Z)(this,"phantomMesh",void 0),(0,u.Z)(this,"phantomShape",void 0),(0,u.Z)(this,"phantomGroup",void 0),(0,u.Z)(this,"world",void 0),(0,u.Z)(this,"gg",void 0),(0,u.Z)(this,"compoundBody",void 0),(0,u.Z)(this,"compoundShapeGroup",void 0),this.x=0,this.y=0,this.z=0,this.phantomX=0,this.phantomY=0,this.phantomZ=0,this.groundX=0,this.groundY=-1,this.groundZ=0,this.size=1,this.mass=10,this.existingBlocks=[],this.phantomBlockAccepted=!1,this.gameLoopLength=.5,this.currentLoopLength=0,this.phantomShape=void 0,this.world=new h.q3({gravity:new h.AO(0,-10,0)}),this._addGround(),this._addCompoundBody(),this.gg=new r.ZAu,this._initGame(),this.compoundShapeGroup=new r.ZAu;var e=new r.DvJ(1,1,1),o=new r.xoR({color:16448250}),n=new r.Kj0(e,o);this.compoundShapeGroup.add(n),this.gg.add(this.compoundShapeGroup),this.phantomGroup=new r.ZAu,this.gg.add(this.phantomGroup)}return(0,p.Z)(t,[{key:"update",value:function(t){this.world.fixedStep(),this.currentLoopLength+=t,this.currentLoopLength>this.gameLoopLength&&(this.currentLoopLength=0,this._displayPhantomBlock())}},{key:"_updateCenterOfMass",value:function(){var t=new h.AO;if(void 0!==this.compoundBody){this.compoundBody.shapeOffsets.forEach((function(e){t.vadd(e,t)})),t.scale(1/this.compoundBody.shapes.length,t),this.compoundBody.shapeOffsets.forEach((function(e){e.vsub(t,e)}));var e=new h.AO;this.compoundBody.vectorToWorldFrame(t,e),this.compoundBody.position.vadd(e,this.compoundBody.position)}}},{key:"_randomizePhantomXYZ",value:function(){var t=this;this._updatePhantomXYZ();var e=function(){var e=Math.floor(3*Math.random()),o=0===Math.floor(2*Math.random())?1:-1;0===e?t.phantomX+=o:1===e?t.y<=.1?t.phantomY=1:t.phantomY+=o:t.phantomZ+=o};e();for(;t.existingBlocks.some((function(e){return e.x===t.phantomX&&e.y===t.phantomY&&e.z===t.phantomZ}));)this._updatePhantomXYZ(),e()}},{key:"addBlockToScene",value:function(t,e,o){var n=new r.DvJ(1,1,1),i=new r.xoR({color:16448250}),s=new r.Kj0(n,i);s.position.x=t,s.position.y=e,s.position.z=o,this.compoundShapeGroup.add(s)}},{key:"_addPhantomBlock",value:function(t,e,o){var n=new r.DvJ(1,1,1),i=new r.xoR({color:6413307,transparent:!0,opacity:.5});if(this.phantomMesh=new r.Kj0(n,i),void 0!==this.compoundBody){var s=this.compoundBody.shapeOffsets[0].x,a=this.compoundBody.shapeOffsets[0].y,h=this.compoundBody.shapeOffsets[0].z;this.phantomMesh.position.x=t+s,this.phantomMesh.position.y=e+a,this.phantomMesh.position.z=o+h,this.phantomGroup.add(this.phantomMesh)}}},{key:"_displayPhantomBlock",value:function(){var t;(this._randomizePhantomXYZ(),this.phantomBlockAccepted)?(this.phantomBlockAccepted=!1,this.addBlockToScene(this.x,this.y,this.z),console.log(null===(t=this.compoundBody)||void 0===t?void 0:t.shapeOffsets)):void 0!==this.compoundBody&&void 0!==this.phantomShape&&this.compoundBody.removeShape(this.phantomShape);if(this.phantomShape=new h.xu(new h.AO(.5*this.size,.5*this.size,.5*this.size)),void 0!==this.compoundBody){var e=this.compoundBody.shapeOffsets[0].x,o=this.compoundBody.shapeOffsets[0].y,n=this.compoundBody.shapeOffsets[0].z;this.compoundBody.addShape(this.phantomShape,new h.AO(this.phantomX*this.size+e,this.phantomY*this.size+o,this.phantomZ*this.size+n)),void 0!==this.phantomMesh&&(this.phantomGroup.remove(this.phantomMesh),this._addPhantomBlock(this.phantomX,this.phantomY,this.phantomZ))}}},{key:"_updatePhantomXYZ",value:function(){this.phantomX=this.x,this.phantomY=this.y,this.phantomZ=this.z}},{key:"_updateXYZ",value:function(){this.x=this.phantomX,this.y=this.phantomY,this.z=this.phantomZ}},{key:"acceptPhantomBlock",value:function(){this._updateXYZ(),this._addExistingBlock(),this._updateCenterOfMass(),this.phantomBlockAccepted=!0,this.currentLoopLength=this.gameLoopLength+1}},{key:"_addExistingBlock",value:function(){this.existingBlocks.push({x:this.x,y:this.y,z:this.z})}},{key:"animatePhantomGroup",value:function(){void 0!==this.compoundBody&&(this.phantomGroup.position.copy(this.compoundBody.position),this.phantomGroup.quaternion.copy(this.compoundBody.quaternion))}},{key:"animateCompoundShapeGroup",value:function(){var t=this;void 0!==this.compoundBody&&(this.compoundShapeGroup.position.copy(this.compoundBody.position),this.compoundShapeGroup.quaternion.copy(this.compoundBody.quaternion),this.compoundShapeGroup.children.forEach((function(e,o){if(void 0!==t.compoundBody){var n=t.compoundBody.shapeOffsets[o],i=t.compoundBody.shapeOrientations[o];e.position.copy(n),e.quaternion.copy(i)}})))}},{key:"_addCompoundBody",value:function(){var t=new h.xu(new h.AO(.5*this.size,.5*this.size,.5*this.size)),e=new h.F5("slippery");e.friction=.01,this.compoundBody=new h.uT({mass:this.mass,material:e}),this.compoundBody.position.set(0,0,0),this.compoundBody.quaternion.setFromEuler(0,0,0),this.compoundBody.addShape(t,new h.AO(this.x,this.y,this.z)),this._addExistingBlock(),this.world.addBody(this.compoundBody)}},{key:"_addGround",value:function(){var t=new h.F5("ground");t.friction=.5;var e=new h.xu(new h.AO(1.5,.5,1.5)),o=new h.uT({mass:0,material:t});o.addShape(e),o.quaternion.setFromEuler(0,0,0),o.position.set(this.groundX,this.groundY,this.groundZ),this.world.addBody(o)}},{key:"_initGame",value:function(){var t=new r.DvJ(3,1,3),e=new r.xoR({color:2195968}),o=new r.Kj0(t,e);o.position.y=-1,this.gg.add(o)}}]),t}(),v=o(5893);var f=function(){var t,e=(0,a.useRef)(0);return(0,a.useEffect)((function(){var i=new m("myThreeJsCanvas"),a=new l;i.scene.add(a.gg);var h=d(i.scene,a.world),r=function(){var e,a=(e=s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.e(376).then(o.bind(o,4376));case 2:n=e.sent,(t=new n.GUI).add(i,"cameraRotationDepth",5,100).name("Camera Distance").onChange((function(t){}));case 5:case"end":return e.stop()}}),e)})),function(){var t=this,o=arguments;return new Promise((function(i,s){var a=e.apply(t,o);function h(t){n(a,i,s,h,r,"next",t)}function r(t){n(a,i,s,h,r,"throw",t)}h(void 0)}))});return function(){return a.apply(this,arguments)}}();r();!function t(){var e=i.clock.getDelta();i.update(),i.udpateCameraPosition(),h.update(),a.update(e),a.animatePhantomGroup(),a.animateCompoundShapeGroup(),requestAnimationFrame(t)}();var c=function(t){a.acceptPhantomBlock()},p=function(t){"Space"===t.code&&a.acceptPhantomBlock()};return window.addEventListener("click",c),window.addEventListener("keydown",p),function(){console.log("on component unmount"),window.removeEventListener("click",c),window.removeEventListener("keydown",p),i.destroy(),window.cancelAnimationFrame(e.current);var o=document.getElementById("myThreeJsCanvas");o.parentNode.removeChild(o),t.destroy()}}),[]),(0,v.jsx)("div",{children:(0,v.jsx)("canvas",{id:"myThreeJsCanvas"})})}},8159:function(t,e,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/frantic-arch",function(){return o(3083)}])},2777:function(t,e,o){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}o.d(e,{Z:function(){return n}})},2262:function(t,e,o){"use strict";function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}o.d(e,{Z:function(){return i}})}},function(t){t.O(0,[737,884,774,888,179],(function(){return e=8159,t(t.s=e);var e}));var e=t.O();_N_E=e}]);