(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{3533:function(i,e,t){"use strict";t.d(e,{W:function(){return s}});var n=t(2777),o=t(2262),s=function(){function i(){(0,n.Z)(this,i)}return(0,o.Z)(i,null,[{key:"removeCanvas",value:function(){var i=document.getElementById("myThreeJsCanvas");i.parentNode.removeChild(i)}},{key:"maybeCreateCanvas",value:function(){var i=document.getElementById("myThreeJsCanvas");i||((i=document.createElement("canvas")).id="myThreeJsCanvas",document.body.appendChild(i))}}]),i}()},1507:function(i,e,t){"use strict";t.r(e),t.d(e,{default:function(){return f}});var n=t(7294),o=t(3533),s=t(2777),a=t(2262),r=t(9499),d=t(9477),h=function(){function i(){(0,s.Z)(this,i),(0,r.Z)(this,"gg",void 0),(0,r.Z)(this,"clock",void 0),(0,r.Z)(this,"uniforms",void 0),(0,r.Z)(this,"boardSize",void 0),(0,r.Z)(this,"boardPositions",void 0),(0,r.Z)(this,"portalPairPositions",void 0),this.clock=new d.SUY,this.uniforms={u_time:{type:"f",value:0}},this.gg=new d.ZAu,this.boardSize=21,this.boardPositions=[];for(var e=-1*Math.floor(this.boardSize/2),t=Math.floor(this.boardSize/2),n=e;n<=t;n++)for(var o=e;o<=t;o++)this.boardPositions.push({x:n,y:o,z:-1});this._initializeBoard(),this.portalPairPositions=[[{x:-8,y:6,z:0,color:"red"},{x:-4,y:2,z:0,color:"red"}],[{x:-4,y:6,z:0,color:"green"},{x:0,y:2,z:0,color:"green"}],[{x:0,y:6,z:0,color:"blue"},{x:4,y:2,z:0,color:"blue"}],[{x:4,y:6,z:0,color:"yellow"},{x:8,y:2,z:0,color:"yellow"}],[{x:8,y:6,z:0,color:"grey"},{x:-8,y:2,z:0,color:"grey"}],[{x:-8,y:-6,z:0,color:"purple"},{x:-4,y:-2,z:0,color:"purple"}],[{x:-4,y:-6,z:0,color:"brown"},{x:0,y:-2,z:0,color:"brown"}],[{x:0,y:-6,z:0,color:"teal"},{x:4,y:-2,z:0,color:"teal"}],[{x:4,y:-6,z:0,color:"violet"},{x:8,y:-2,z:0,color:"violet"}],[{x:8,y:-6,z:0,color:"pink"},{x:-8,y:-2,z:0,color:"pink"}]],this._initializePortalPairs()}return(0,a.Z)(i,[{key:"_initializePortalPairs",value:function(){var i=this;this.portalPairPositions.forEach((function(e){var t=e[0],n=e[1];i._createIndividualPortal(t),i._createIndividualPortal(n)}))}},{key:"_createIndividualPortal",value:function(i){var e=new d.DvJ(1,1,1),t=new d.xoR({color:i.color}),n=new d.Kj0(e,t);n.position.x=i.x,n.position.y=i.y,n.position.z=i.z,this.gg.add(n)}},{key:"update",value:function(i){this.uniforms.u_time.value=i/1e3}},{key:"_initializeBoard",value:function(){var i=this;this.boardPositions.forEach((function(e){i._createIndividualBoardPart(e)}))}},{key:"_createIndividualBoardPart",value:function(i){var e=new d.DvJ(1,1,1),t=new d.xoR({color:1052688}),n=new d.Kj0(e,t);n.position.x=i.x,n.position.y=i.y,n.position.z=i.z,this.gg.add(n)}}]),i}(),c=t(6194),u=function(){function i(e,t){(0,s.Z)(this,i),(0,r.Z)(this,"gg",void 0),(0,r.Z)(this,"clock",void 0),(0,r.Z)(this,"snackGroup",void 0),(0,r.Z)(this,"bodyPositions",void 0),(0,r.Z)(this,"speed",1),(0,r.Z)(this,"xSpeed",0),(0,r.Z)(this,"ySpeed",0),(0,r.Z)(this,"timeStep",300),(0,r.Z)(this,"snackStep",150),(0,r.Z)(this,"elaplsedTime",.3),(0,r.Z)(this,"isMoving",!1),(0,r.Z)(this,"snack",void 0),(0,r.Z)(this,"boardSize",void 0),(0,r.Z)(this,"portalPairPositions",void 0),this.boardSize=e,this.snack={x:0,y:0,z:0},this.portalPairPositions=t,this.gg=new d.ZAu,this.clock=new d.SUY,this.snackGroup=new d.ZAu,this.clock.start(),this.bodyPositions=[{x:0,y:0,z:0},{x:1,y:0,z:0},{x:1,y:1,z:0},{x:1,y:2,z:0},{x:1,y:3,z:0},{x:1,y:4,z:0},{x:1,y:5,z:0},{x:1,y:6,z:0}],this._initializeSnake(),this._initializeSnack()}return(0,a.Z)(i,[{key:"_randomizeSnackCoordinates",value:function(){return{x:Math.floor(Math.random()*this.boardSize)-Math.floor(this.boardSize/2),y:Math.floor(Math.random()*this.boardSize)-Math.floor(this.boardSize/2),z:0}}},{key:"_initializeSnack",value:function(){for(var i=this,e=this._randomizeSnackCoordinates(),t=function(e){return i.bodyPositions.some((function(t){return i._distance(t,e)<.1}))},n=function(e){var t=[];return i.portalPairPositions.forEach((function(i){t.push(i[0]),t.push(i[1])})),t.some((function(t){return i._distance(e,t)<.1}))};;)if(t(e))e=this._randomizeSnackCoordinates();else{if(!n(e))break;e=this._randomizeSnackCoordinates()}this.snack=e,this._renderSnack()}},{key:"_renderSnack",value:function(){var i=this;setTimeout((function(){i.snackGroup.children.forEach((function(e){i.snackGroup.remove(e)}));var e=new d.xo$(.5),t=new d.RSm,n=new d.Kj0(e,t);n.position.x=i.snack.x,n.position.y=i.snack.y,n.position.z=i.snack.z,i.snackGroup.add(n)}),100)}},{key:"_initializeSnake",value:function(){var i=this;this.bodyPositions.forEach((function(e,t){var n=0===t;i._createIndividualSnakePart(e,n)}))}},{key:"_createIndividualSnakePart",value:function(i,e){var t,n=new d.DvJ(1,1,1);t=e?new d.RSm({transparent:!0,opacity:.5}):new d.RSm;var o=new d.Kj0(n,t);o.position.x=i.x,o.position.y=i.y,this.gg.add(o)}},{key:"render",value:function(){for(var i=0;i<this.bodyPositions.length;i++){var e=this.bodyPositions[i],t=e.x,n=e.y,o=e.z;this.gg.children[i].position.set(t,n,o)}}},{key:"_distance",value:function(i,e){var t=Math.pow(i.x-e.x,2),n=Math.pow(i.y-e.y,2);return Math.sqrt(t+n)}},{key:"update",value:function(i){var e=this;if(c.Vx(i),this.isMoving&&(this.render(),!(this.clock.getElapsedTime()<this.elaplsedTime))){this.clock.start();for(var t=function(i){var t={x:e.bodyPositions[i].x,y:e.bodyPositions[i].y,z:e.bodyPositions[i].z},n=void 0;if(0===i){n={x:e.bodyPositions[0].x+e.xSpeed,y:e.bodyPositions[0].y+e.ySpeed,z:e.bodyPositions[0].z};for(var o=0;o<e.portalPairPositions.length;o++){var s=e.portalPairPositions[o][0],a=e.portalPairPositions[o][1];e._distance(n,s)<.1?(n.x=a.x+e.xSpeed,n.y=a.y+e.ySpeed):e._distance(n,a)<.1&&(n.x=s.x+e.xSpeed,n.y=s.y+e.ySpeed)}if(e._distance(n,e.snack)<.1){e._initializeSnack();var r=e.gg.children[e.gg.children.length-1],d={x:Math.round(r.position.x),y:Math.round(r.position.y),z:0};e.bodyPositions.push({x:Math.round(r.position.x),y:Math.round(r.position.y),z:0}),e._createIndividualSnakePart(d,!1)}}else n={x:e.bodyPositions[i-1].x,y:e.bodyPositions[i-1].y,z:e.bodyPositions[i-1].z};new c.kX(t).to(n,e.timeStep).easing(c.oY.Cubic.InOut).onUpdate((function(){e.bodyPositions[i].x=t.x,e.bodyPositions[i].y=t.y,e.bodyPositions[i].z=t.z})).start()},n=0;n<this.bodyPositions.length;n++)t(n)}}},{key:"handleMovement",value:function(i){["w","a","s","d"].includes(i.key)?this.isMoving=!0:this.isMoving=!1,"w"===i.key?(this.xSpeed=0,this.ySpeed=this.speed):"a"===i.key?(this.xSpeed=-this.speed,this.ySpeed=0):"s"===i.key?(this.xSpeed=0,this.ySpeed=-this.speed):"d"===i.key&&(this.xSpeed=this.speed,this.ySpeed=0)}}]),i}(),l=t(9365),v=t(5079),y=function(){function i(e){var t=this;(0,s.Z)(this,i),(0,r.Z)(this,"canvasId",void 0),(0,r.Z)(this,"fov",void 0),(0,r.Z)(this,"nearPlane",void 0),(0,r.Z)(this,"farPlane",void 0),(0,r.Z)(this,"canvas",void 0),(0,r.Z)(this,"onWindowResize",void 0),(0,r.Z)(this,"scene",void 0),(0,r.Z)(this,"camera",void 0),(0,r.Z)(this,"renderer",void 0),(0,r.Z)(this,"clock",void 0),(0,r.Z)(this,"stats",void 0),(0,r.Z)(this,"controls",void 0),(0,r.Z)(this,"ambientLight",void 0),(0,r.Z)(this,"directionalLight",void 0),this.fov=45,this.nearPlane=1,this.farPlane=1e3,this.canvasId=e,this.scene=new d.xsS,this.camera=new d.cPb(this.fov,window.innerWidth/window.innerHeight,this.nearPlane,this.farPlane),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=28,this.canvas=document.getElementById(this.canvasId),this.renderer=new d.CP7({canvas:this.canvas,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.clock=new d.SUY,this.controls=new l.z(this.camera,this.renderer.domElement),this.stats=(0,v.Z)(),document.body.appendChild(this.stats.dom),this.ambientLight=new d.Mig(16777215,.5),this.ambientLight.castShadow=!0,this.scene.add(this.ambientLight),this.directionalLight=new d.Ox3(16777215,1),this.directionalLight.position.set(0,4,10),this.scene.add(this.directionalLight),this.onWindowResize=function(){console.log("resize"),t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix(),t.renderer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this.onWindowResize,!1)}return(0,a.Z)(i,[{key:"destroy",value:function(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);this.scene.removeFromParent(),this.camera.removeFromParent(),document.body.removeChild(this.stats.dom),window.removeEventListener("resize",this.onWindowResize)}},{key:"update",value:function(){this.render(),this.stats.update(),this.controls.update()}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}}]),i}(),p=t(5893);var f=function(){var i=(0,n.useRef)(0);return(0,n.useEffect)((function(){o.W.maybeCreateCanvas();var e=new y("myThreeJsCanvas"),t=new h;e.scene.add(t.gg);var n=new u(t.boardSize,t.portalPairPositions);e.scene.add(n.gg),e.scene.add(n.snackGroup);return requestAnimationFrame((function o(s){e.update(),t.update(s),n.update(s),i.current=window.requestAnimationFrame(o)})),window.addEventListener("keydown",(function(i){return n.handleMovement(i)})),function(){console.log("on component unmount"),e.destroy(),window.cancelAnimationFrame(i.current),o.W.removeCanvas()}})),(0,p.jsx)("div",{children:(0,p.jsx)("canvas",{id:"myThreeJsCanvas"})})}},7945:function(i,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/snakes-and-portals",function(){return t(1507)}])}},function(i){i.O(0,[737,273,774,888,179],(function(){return e=7945,i(i.s=e);var e}));var e=i.O();_N_E=e}]);